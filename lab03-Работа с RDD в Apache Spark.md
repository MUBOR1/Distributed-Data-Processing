# –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ ‚Ññ3: –†–∞–±–æ—Ç–∞ —Å RDD –≤ Apache Spark

## –¶–µ–ª—å —Ä–∞–±–æ—Ç—ã
–û—Å–≤–æ–∏—Ç—å –±–∞–∑–æ–≤—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã —Ä–∞–±–æ—Ç—ã —Å –Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤–æ–π –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–µ–π Apache Spark ‚Äî **RDD (Resilient Distributed Dataset)**.  
–ü–æ–ª—É—á–∏—Ç—å –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –Ω–∞–≤—ã–∫–∏ —Å–æ–∑–¥–∞–Ω–∏—è RDD, –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–π (**transformations**) –∏ –¥–µ–π—Å—Ç–≤–∏–π (**actions**), –∞ —Ç–∞–∫–∂–µ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π –æ–ø–µ—Ä–∞—Ü–∏–π (**DAG**).

---

## –°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π

- **–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞/–û–°:** Linux (Ubuntu)  
- **–§—Ä–µ–π–º–≤–æ—Ä–∫:** Apache Spark 3.5.0  
- **–Ø–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è:** Python (PySpark)  
- **–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞—Ä–∏–π:** Spark Standalone Mode  
- **–î–∞–Ω–Ω—ã–µ:** –õ–æ–≥–∏ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞, —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ

---

## –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∞—è —á–∞—Å—Ç—å

### RDD (Resilient Distributed Dataset)

RDD ‚Äî —ç—Ç–æ –Ω–µ–∏–∑–º–µ–Ω—è–µ–º–∞—è, –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–∞—è –∫–æ–ª–ª–µ–∫—Ü–∏—è –æ–±—ä–µ–∫—Ç–æ–≤, —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–∞—è –º–µ–∂–¥—É —É–∑–ª–∞–º–∏ –∫–ª–∞—Å—Ç–µ—Ä–∞, –∫–æ—Ç–æ—Ä—ã–º–∏ –º–æ–∂–Ω–æ –º–∞–Ω–∏–ø—É–ª–∏—Ä–æ–≤–∞—Ç—å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ.

**Resilient (–£—Å—Ç–æ–π—á–∏–≤—ã–π):** —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å—Å—è –ø–æ—Å–ª–µ —Å–±–æ–µ–≤ –±–ª–∞–≥–æ–¥–∞—Ä—è *lineage* (—Ü–µ–ø–æ—á–∫–µ –ø—Ä–æ–∏—Å—Ö–æ–∂–¥–µ–Ω–∏—è)  
**Distributed (–†–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–π):** –¥–∞–Ω–Ω—ã–µ —Ä–∞–∑–¥–µ–ª–µ–Ω—ã –Ω–∞ –ø–∞—Ä—Ç–∏—Ü–∏–∏ (*partitions*) –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —É–∑–ª–∞—Ö –∫–ª–∞—Å—Ç–µ—Ä–∞  
**Dataset (–ù–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö):** –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –Ω–∞–±–æ—Ä –æ–±—ä–µ–∫—Ç–æ–≤

---

### –û–ø–µ—Ä–∞—Ü–∏–∏ –Ω–∞–¥ RDD

- **–¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ (Transformations):** "–ª–µ–Ω–∏–≤—ã–µ" –æ–ø–µ—Ä–∞—Ü–∏–∏, —Å–æ–∑–¥–∞—é—â–∏–µ –Ω–æ–≤–æ–µ RDD –∏–∑ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ  
- **–î–µ–π—Å—Ç–≤–∏—è (Actions):** –æ–ø–µ—Ä–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞–ø—É—Å–∫–∞—é—Ç –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç

---

## –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

### –ß–∞—Å—Ç—å 1. –ë–∞–∑–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å RDD

#### 1.1 –°–æ–∑–¥–∞–Ω–∏–µ RDD –∏–∑ –∫–æ–ª–ª–µ–∫—Ü–∏–∏

```python
numbers_rdd = sc.parallelize(range(1, 1001))
print(f"–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤: {numbers_rdd.count()}")
print(f"–ü–µ—Ä–≤—ã–µ 10 —ç–ª–µ–º–µ–Ω—Ç–æ–≤: {numbers_rdd.take(10)}")
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ numbers_rdd: 1000
–ü–µ—Ä–≤—ã–µ 10 —ç–ª–µ–º–µ–Ω—Ç–æ–≤: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
```

![–°–ö–†–ò–ù–®–û–¢ 1: –°–æ–∑–¥–∞–Ω–∏–µ RDD –∏–∑ –∫–æ–ª–ª–µ–∫—Ü–∏–∏ ‚Äî –≤—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤](./image/result_rdd.png)

üì∑ *[–°–ö–†–ò–ù–®–û–¢ 1: –°–æ–∑–¥–∞–Ω–∏–µ RDD –∏–∑ –∫–æ–ª–ª–µ–∫—Ü–∏–∏ ‚Äî –≤—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤]*


---

#### 1.2 –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–π –∫ —á–∏—Å–ª–∞–º

```python
even_numbers = numbers_rdd.filter(lambda x: x % 2 == 0)
squared_numbers = even_numbers.map(lambda x: x ** 2)
result_numbers = numbers_rdd.filter(lambda x: x % 2 == 0).map(lambda x: x ** 2)
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
–ß–µ—Ç–Ω—ã–µ —á–∏—Å–ª–∞ (–ø–µ—Ä–≤—ã–µ 10): [2, 4, 6, 8, 10, 12, 14, 16, 18, 20]
–ö–≤–∞–¥—Ä–∞—Ç—ã —á–µ—Ç–Ω—ã—Ö —á–∏—Å–µ–ª (–ø–µ—Ä–≤—ã–µ 10): [4, 16, 36, 64, 100, 144, 196, 256, 324, 400]
–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Å–ª–µ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –∏ –º–∞–ø–ø–∏–Ω–≥–∞: 500
```

![–°–ö–†–ò–ù–®–û–¢ 2: –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ —Å —á–∏—Å–ª–∞–º–∏ ‚Äî —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏ –º–∞–ø–ø–∏–Ω–≥](./image/maping_result.png)

üì∑ *[–°–ö–†–ò–ù–®–û–¢ 2: –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ —Å —á–∏—Å–ª–∞–º–∏ ‚Äî —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏ –º–∞–ø–ø–∏–Ω–≥]*

---

#### 1.3 –°–æ–∑–¥–∞–Ω–∏–µ RDD –∏–∑ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ —Ñ–∞–π–ª–∞

**–¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ (`log.txt`):**
```text
INFO: Server started on port 8080
ERROR: Database connection failed
INFO: User john logged in
WARNING: High memory usage detected
ERROR: File not found: /home/user/data.txt
INFO: Request processed in 45ms
ERROR: Authentication failed for user alice
INFO: Backup completed successfully
WARNING: Disk space running low
ERROR: Network timeout after 30s
INFO: Cache cleared
```

```python
log_rdd = sc.textFile("file:///home/clay/spark_lab3/log.txt")
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫ –≤ –ª–æ–≥–∞—Ö: 11
–ü–µ—Ä–≤—ã–µ 5 —Å—Ç—Ä–æ–∫ –ª–æ–≥–æ–≤:
['INFO: Server started on port 8080',
 'ERROR: Database connection failed',
 'INFO: User john logged in',
 'WARNING: High memory usage detected',
 'ERROR: File not found: /home/user/data.txt']
```

![–°–ö–†–ò–ù–®–û–¢ 3: –°–æ–∑–¥–∞–Ω–∏–µ RDD –∏–∑ —Ñ–∞–π–ª–∞ –∏ –≤—ã–≤–æ–¥ –ª–æ–≥–æ–≤](./image/rdd_log.png)

üì∑ *[–°–ö–†–ò–ù–®–û–¢ 3: –°–æ–∑–¥–∞–Ω–∏–µ RDD –∏–∑ —Ñ–∞–π–ª–∞ –∏ –≤—ã–≤–æ–¥ –ª–æ–≥–æ–≤]*

---

#### 1.4 –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–π –∫ –ª–æ–≥–∞–º

```python
upper_logs = log_rdd.map(lambda line: line.upper())
error_logs = log_rdd.filter(lambda line: "ERROR" in line.upper())
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
–õ–æ–≥–∏ –≤ –≤–µ—Ä—Ö–Ω–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–µ (–ø–µ—Ä–≤—ã–µ 5):
['INFO: SERVER STARTED ON PORT 8080',
 'ERROR: DATABASE CONNECTION FAILED',
 'INFO: USER JOHN LOGGED IN',
 'WARNING: HIGH MEMORY USAGE DETECTED',
 'ERROR: FILE NOT FOUND: /HOME/USER/DATA.TXT']

–°—Ç—Ä–æ–∫–∏ —Å ERROR (–≤—Å–µ):
['ERROR: Database connection failed',
 'ERROR: File not found: /home/user/data.txt',
 'ERROR: Authentication failed for user alice',
 'ERROR: Network timeout after 30s']

–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—à–∏–±–æ–∫: 4
```

![–°–ö–†–ò–ù–®–û–¢ 4: –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ —Å –ª–æ–≥–∞–º–∏ ‚Äî –º–∞–ø–ø–∏–Ω–≥ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è](./image/rdd_log.png)

üì∑ *[–°–ö–†–ò–ù–®–û–¢ 4: –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ —Å –ª–æ–≥–∞–º–∏ ‚Äî –º–∞–ø–ø–∏–Ω–≥ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è]*

---

### –ß–∞—Å—Ç—å 2. –ê–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞

**–¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ (`access_log.txt`):**
```text
127.0.0.1 - - [01/Jan/2023:00:00:01 +0000] "GET /index.html HTTP/1.0" 200 1234
127.0.0.1 - - [01/Jan/2023:00:00:02 +0000] "GET /about.html HTTP/1.0" 200 2345
127.0.0.1 - - [01/Jan/2023:00:00:03 +0000] "GET /index.html HTTP/1.0" 200 1234
...
```

#### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∞–Ω–∞–ª–∏–∑–∞

```python
def extract_url(line):
    try:
        parts = line.split()
        if len(parts) > 6:
            return parts[6]
        else:
            return None
    except:
        return None

# –û—Å–Ω–æ–≤–Ω–æ–π –ø–∞–π–ø–ª–∞–π–Ω –æ–±—Ä–∞–±–æ—Ç–∫–∏
url_counts = (web_log_rdd
             .map(extract_url)
             .filter(lambda x: x is not None)
             .map(lambda url: (url, 1))
             .reduceByKey(lambda a, b: a + b))

top_urls = url_counts.sortBy(lambda x: x[1], ascending=False)
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
–í—Å–µ–≥–æ –∑–∞–ø–∏—Å–µ–π –≤ –ª–æ–≥–∞—Ö: 15
–ü—Ä–∏–º–µ—Ä—ã –∏–∑–≤–ª–µ—á–µ–Ω–Ω—ã—Ö URL: ['/index.html', '/about.html', '/index.html', '/contact.html', '/login.php']
```

![–°–ö–†–ò–ù–®–û–¢ 5: –ê–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤ ‚Äî –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ URL –∏ –ø–æ–¥—Å—á–µ—Ç](./image/log_result_analyz1.png)

üì∑ *[–°–ö–†–ò–ù–®–û–¢ 5: –ê–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤ ‚Äî –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ URL –∏ –ø–æ–¥—Å—á–µ—Ç]*

---

### –¢–æ–ø-10 —Å–∞–º—ã—Ö –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö URL

```text
=== –¢–û–ü-10 –°–ê–ú–´–• –ü–û–ü–£–õ–Ø–†–ù–´–• URL ===
 1. /index.html     -  5 –æ–±—Ä–∞—â–µ–Ω–∏–π
 2. /about.html     -  3 –æ–±—Ä–∞—â–µ–Ω–∏–π
 3. /contact.html   -  3 –æ–±—Ä–∞—â–µ–Ω–∏–π
 4. /products.html  -  2 –æ–±—Ä–∞—â–µ–Ω–∏–π
 5. /login.php      -  1 –æ–±—Ä–∞—â–µ–Ω–∏–π
 6. /services.html  -  1 –æ–±—Ä–∞—â–µ–Ω–∏–π
```

![–°–ö–†–ò–ù–®–û–¢ 6: –§–∏–Ω–∞–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç ‚Äî —Ç–æ–ø-10 URL](./image/log_result_analyz2.png)


üì∑ *[–°–ö–†–ò–ù–®–û–¢ 6: –§–∏–Ω–∞–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç ‚Äî —Ç–æ–ø-10 URL]*
---

### –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

```python
top_urls_alt = (urls_rdd
               .map(lambda url: (url, 1))
               .reduceByKey(lambda a, b: a + b)
               .map(lambda x: (x[1], x[0]))
               .sortByKey(ascending=False)
               .map(lambda x: (x[1], x[0])))
```

![–°–ö–†–ò–ù–®–û–¢ 7: –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å sortByKey](./image/sortbykey_result.png)

üì∑ *[–°–ö–†–ò–ù–®–û–¢ 7: –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å sortByKey]*

---

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

```
–í—Å–µ–≥–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤: 1026
–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö URL: 6
```

![–°–ö–†–ò–ù–®–û–¢ 8: –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è](./image/finish_spark.png)

üì∑ *[–°–ö–†–ò–ù–®–û–¢ 8: –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è]*

![Spark](./image/spark_ui.png)

üì∑ *[Spark UI]*

---

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

 ![–°–ö–†–ò–ù–®–û–¢ 10: –§–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–∞ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π —Ä–∞–±–æ—Ç—ã](./image/all_files.png)

üì∑ *[–°–ö–†–ò–ù–®–û–¢ 10: –§–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–∞ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π —Ä–∞–±–æ—Ç—ã]*

**–°–æ–¥–µ—Ä–∂–∏–º–æ–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏:**
```text
lab3_full.py          # –ü–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π —Ä–∞–±–æ—Ç—ã
lab3_with_ui.py       # –í–µ—Ä—Å–∏—è —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π –¥–ª—è Web UI
log.txt               # –¢–µ—Å—Ç–æ–≤—ã–µ –ª–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
access_log.txt        # –í–µ–±-–ª–æ–≥–∏ –≤ Common Log Format
lab3_output.txt       # –ü–æ–ª–Ω—ã–π –≤—ã–≤–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
```

---

## –û—Ç–≤–µ—Ç—ã –Ω–∞ —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã

### 1. –ß–µ–º —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç –¥–µ–π—Å—Ç–≤–∏—è –≤ Spark?

**–¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏** ‚Äî "–ª–µ–Ω–∏–≤—ã–µ" –æ–ø–µ—Ä–∞—Ü–∏–∏, —Å–æ–∑–¥–∞—é—â–∏–µ –Ω–æ–≤—ã–µ RDD, –Ω–æ –Ω–µ –≤—ã–ø–æ–ª–Ω—è—é—â–∏–µ—Å—è —Å—Ä–∞–∑—É. –û–Ω–∏ —Ñ–æ—Ä–º–∏—Ä—É—é—Ç –ø–ª–∞–Ω –≤—ã—á–∏—Å–ª–µ–Ω–∏–π (DAG).  
**–î–µ–π—Å—Ç–≤–∏—è** ‚Äî –æ–ø–µ—Ä–∞—Ü–∏–∏, –∑–∞–ø—É—Å–∫–∞—é—â–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –¥—Ä–∞–π–≤–µ—Ä –∏–ª–∏ –≤–æ –≤–Ω–µ—à–Ω–µ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ.

| –ê—Å–ø–µ–∫—Ç | –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ | –î–µ–π—Å—Ç–≤–∏—è |
|:--|:--|:--|
| –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è | –û—Ç–ª–æ–∂–µ–Ω–Ω–æ–µ (–ª–µ–Ω–∏–≤–æ–µ) | –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ–µ |
| –†–µ–∑—É–ª—å—Ç–∞—Ç | –ù–æ–≤–æ–µ RDD | –ó–Ω–∞—á–µ–Ω–∏–µ –∏–ª–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ |
| –ó–∞–ø—É—Å–∫ –≤—ã—á–∏—Å–ª–µ–Ω–∏–π | –ù–µ –∑–∞–ø—É—Å–∫–∞—é—Ç | –ó–∞–ø—É—Å–∫–∞—é—Ç –≤—Å–µ –ø—Ä–µ–¥—ã–¥—É—â–∏–µ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ |
| –ü—Ä–∏–º–µ—Ä—ã | `map()`, `filter()`, `reduceByKey()` | `count()`, `collect()`, `take()` |

**–ü—Ä–∏–º–µ—Ä:**
```python
# –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ (–Ω–µ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —Å—Ä–∞–∑—É)
even_numbers = numbers_rdd.filter(lambda x: x % 2 == 0)
squared_numbers = even_numbers.map(lambda x: x ** 2)

# –î–µ–π—Å—Ç–≤–∏–µ (–∑–∞–ø—É—Å–∫–∞–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ)
result = squared_numbers.count()  # –ó–∞–ø—É—Å–∫–∞–µ—Ç –≤–µ—Å—å –ø–∞–π–ø–ª–∞–π–Ω
```

---

### 2. –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç reduceByKey –∏ –ø–æ—á–µ–º—É –æ–Ω —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–µ–µ groupByKey?

**reduceByKey** —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –¥–≤–∞ —ç—Ç–∞–ø–∞:
1. –õ–æ–∫–∞–ª—å–Ω–∞—è –∞–≥—Ä–µ–≥–∞—Ü–∏—è –Ω–∞ –∫–∞–∂–¥–æ–π –ø–∞—Ä—Ç–∏—Ü–∏–∏  
2. –ì–ª–æ–±–∞–ª—å–Ω–∞—è –∞–≥—Ä–µ–≥–∞—Ü–∏—è –ø–æ—Å–ª–µ shuffle  

**groupByKey** ‚Äî –ø–µ—Ä–µ–¥–∞–µ—Ç –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è —á–µ—Ä–µ–∑ —Å–µ—Ç—å –±–µ–∑ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏.

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ reduceByKey:**
- –ú–µ–Ω—å—à–µ —Å–µ—Ç–µ–≤–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞  
- –õ—É—á—à–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å  
- –ú–µ–Ω—å—à–µ –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ –ø–∞–º—è—Ç—å

**–ü—Ä–∏–º–µ—Ä:**
```python
# –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ
url_counts = urls_rdd.map(lambda url: (url, 1)).reduceByKey(lambda a, b: a + b)

# –ù–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ
url_counts = urls_rdd.map(lambda url: (url, 1)).groupByKey().mapValues(len)
```

**–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∞–∑–Ω–∏—Ü—ã:**
```text
reduceByKey: (url,1) + (url,1) ‚Üí (url,2) [–Ω–∞ –º–∞–ø–ø–µ—Ä–µ] ‚Üí shuffle ‚Üí (url,2)
groupByKey:  (url,1) + (url,1) ‚Üí shuffle ‚Üí [(url,1), (url,1)] ‚Üí (url,2)
```

---

### 3. –ü–æ—á–µ–º—É RDD ‚Äî –Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è –∞–±—Å—Ç—Ä–∞–∫—Ü–∏—è?

| –ü—Ä–∏–∑–Ω–∞–∫ | RDD | DataFrame |
|:--|:--|:--|
| –°—Ö–µ–º–∞ | –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç | –ï—Å—Ç—å —Å—Ç—Ä–æ–≥–∞—è —Å—Ö–µ–º–∞ |
| –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è | –†—É—á–Ω–∞—è | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è (Catalyst Optimizer) |
| –ò—Å–ø–æ–ª–Ω–µ–Ω–∏–µ | –ë–µ–∑ Tungsten | –° Tungsten engine |
| API | –ù–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π | –í—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π |
| –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å | –ú–µ–¥–ª–µ–Ω–Ω–µ–µ | –ë—ã—Å—Ç—Ä–µ–µ |

RDD —Ç—Ä–µ–±—É—é—Ç –±–æ–ª—å—à–µ —Ä—É—á–Ω–æ–π —Ä–∞–±–æ—Ç—ã –∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –¥–≤–∏–∂–∫–∞ **Spark SQL**, –ø–æ—ç—Ç–æ–º—É —Å—á–∏—Ç–∞—é—Ç—Å—è –Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤–æ–π –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–µ–π.
